# IP

### 인터넷 프로토콜

> 네트워크 계층의 가장 핵심적인 프로토콜입니다. IPv4와 IPv6가 존재합니다.

### IP주소 구성

#### 네트워크 주소와 호스트 주소

* 네트워크 주소와 호스트 주소를 구분하는 범위는 유동적입니다.
  *   네트워크 주소가 하나의 옥텟으로 이루어진 경우

      <figure><img src="../../.gitbook/assets/네트워크.PNG" alt=""><figcaption></figcaption></figure>
  *   네트워크 주소가 세 개의 옥텟으로 이루어진 경우

      <figure><img src="../../.gitbook/assets/image (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

      ![](https://prod-files-secure.s3.us-west-2.amazonaws.com/e7472e42-7118-406f-8758-f9c76b1cf86a/6529f8fe-d0fb-467f-8bcf-97dca6fee997/Untitled.png)
* 다음은 네트워크 주소가 16비트, 호스트 주소가 16비트인 IP 주소의 예시입니다.

<figure><img src="../../.gitbook/assets/image (8).png" alt=""><figcaption></figcaption></figure>

### 클래스



#### 배경

호스트 주소 공간을 크게 할당하면 호스트가 할당되지 않은 다수의 IP가 낭비됩니다. 호스트 주소 공간을 작게 할당하면 호스트가 사용할 IP 주소가 부족해질 수 있습니다. 이와 같은 문제를 해결하기 위한 개념이 IP 주소의 클래스입니다.

#### 클래스풀 주소 체계

클래스는 네트워크 크기에 따라 IP 주소를 분류하는 기준입니다. 클래스를 이용하면 필요한 호스트 IP 개수에 따라 **네트워크 크기를 가변적으로 조정**해 **네트워크 주소와 호스트 주소를 구획**할 수 있습니다. **클래스를 기반으로 IP 주소를 관리하는 주소 체계**를 클래스풀 주소 체계라고 합니다.

<figure><img src="../../.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/e7472e42-7118-406f-8758-f9c76b1cf86a/e2e65c30-6078-45cb-a550-ae9aa4fe4838/Untitled.png)

| \`클래스명 | 네트워크 옥텟 | 시작 네트워크 비트 | 가장 처음 옥텟 주소 | 네트워크 갯수 | 호스트 주소 갯수 | 네트워크 주소 비트/호스트 주소 비트 |
| ------ | ------- | ---------- | ----------- | ------- | --------- | -------------------- |
| A      | 1       | 0          | 0\~127      | 2^7개    | 2^24-2개   | 8/24                 |
| B      | 2       | 10         | 128\~191    | 2^14개   | 2^14-2개   | 16/16                |
| C      | 3       | 110        | 192\~223    | 2^21개   | 2^8-2개    | 24/8                 |

### 클래스리스 주소 체계

#### 클래스풀 주소 체계의 한계

1. 클래스별 네트워크의 크기가 고정되어 있기 때문에 다수의 IP 주소가 낭비될 가능성이 있습니다.
   * A클래스로 할당 가능한 호스트 IP의 개수는 1,600만개 이상, B클래스는 6만개가 넘습니다.
2. A,B,C 클래스 외에는 다른 크기의 네트워크를 구성할 수 없습니다.
   *   300명의 인원이 사용할 경우 어쩔 수 없이 B클래스를 이용해야합니다.

       (c클래스가 호스트에 할당할 수 있는 주소의 갯수는 254개 뿐이기 때문)

📌 클래스풀 주소 체계보다 유동적이고 정교하게 네트워크를 구획할 수 있는 주소 체계가 필요해졌습니다.

#### 서브넷 마스크

클래스리스 주소 체계에서 네트워크와 호스트를 구분하는 수단으로 사용합니다.

### IP 주소 형태

#### IPv4

> 4바이트로 주소를 표현할 수 있고, 숫자당 8비트로 표현됩니다. → 0\~255 범위 안에 있는 4개의 10진수로 표기됩니다
>
> 각 10진수는 . 으로 구분되며, 점으로 구분된 8비트를 옥텟이라고 합니다.
>
> ```java
> 192.168.1.1
> ```



<figure><img src="../../.gitbook/assets/image (6).png" alt=""><figcaption></figcaption></figure>

<table><thead><tr><th width="156">헤더 속성</th><th>설명 </th></tr></thead><tbody><tr><td>식별자</td><td><ul><li>패킷에 할당된 번호입니다. </li><li>여러개로 쪼개서 보내질 경우 재조합하기 위해서 사용합니다.</li></ul></td></tr><tr><td>플래그 DF</td><td><ul><li>1로 설정되어 있다면 단편화를 수행하지 않습니다.</li><li>0이면 마지막, 1이면 아직 더 남아있음을 의미합니다.</li></ul></td></tr><tr><td>플래그 MF</td><td><ul><li>단편화되기 전 패킷의 초기 데이터에서 몇 번째로 떨어진 패킷인지 나타냅니다.</li><li>0이면 마지막, 1이면 아직 더 남아있음을 의미합니다.</li></ul></td></tr><tr><td>단편화 오프셋</td><td><ul><li>단편화되기 전 패킷의 초기 데이터에서 몇 번째로 떨어진 패킷인지 나타냅니다.</li></ul></td></tr><tr><td>TTL</td><td><ul><li>패킷의 수명을 의미합니다.</li><li>하나의 라우터, 호스트를 거칠 때(=홉)마다 TTL이 1씩 감소하며, 0으로 떨어진 패킷은 폐기됩니다.</li><li>무의미한 패킷이 네트워크 상에서 지속적으로 남아있는 것을 방지합니다.</li></ul></td></tr><tr><td>프로토콜</td><td><ul><li>상위 계층의 프로토콜이 무엇인지 나타냅니다.</li></ul></td></tr></tbody></table>



#### IPv6

> IPv4주소는 이론적으로 약 43억개를 할당가능합니다. IPv4 주소가 고갈될 것을 우려해 등장한 것이 IPv6입니다. 16바이트로 표현가능합니다. :으로 구분된 8개 그룹의 16진수로 표기합니다.

<figure><img src="../../.gitbook/assets/image (7).png" alt=""><figcaption></figcaption></figure>

### 기능

#### IP 주소 지정

> IP 주소를 바탕으로 송수신 대상을 지정하는 것을 의미합니다.

#### IP 단편화

> 패킷의 크기가 MTU라는 최대 전송 단위보다 클 경우 MTU 이하의 여러 개의 패킷으로 나눕니다.

💡IP 단편화는 최대한 피하는 것이 좋습니다.

* 데이터가 여러 패킷으로 쪼개지면 자연스레 전송해야할 패킷의 헤더가 많아집니다.
* 이는 불필요한 트래픽 증가와 대역폭 낭비로 이어집니다.
* 쪼개진 IP 패킷을 하나로 합치는 과정에서 발생하는 부하도 성능저하를 일으킵니다.

💡IP 단편화를 피하는 방법 (=경로 MTU 발견)

* IP 단편화 없이 주고 받을 수 있는 최대 크기(경로 MTU)만큼만 전송해야합니다.

#### MTU

> 한 번에 전송가능한 IP 패킷의 최대 크기입니다.

* 헤더도 포함됩니다.
* 일반적인 크기는 1500 바이트입니다.
* MTU 이하로 나누어진 패킷은 수신지에 도착하면서 다시 재조합됩니다.
